{% extends "mypage-base.html" %}
{% load static %}

{% block css %}
<link href="{% static 'css/table.css' %}" rel="stylesheet">
<style>
    #contract_list {
        border-color: #3189AE;
    }
    #contract_list p {
        color: #3189AE;
    }
</style>
{% endblock css %}

{% block sidebar %}
<div class="contents-header">
    <div class="contents-header-left">마이페이지</div>
    <div class="contents-header-right">
    <a href="/main"><i class="fas fa-home"></i></a> &nbsp; > &nbsp; <a href="/mypage">마이페이지</a> &nbsp; > &nbsp; <a class="header-right-last" href="/contract_list">회사간 계약 현황</a>
    </div>
</div>
<hr class="contents-header-hr">    
{% endblock sidebar %}

{% block content %}
    <div class="col-lg-9">
        <div class="contents">
            <div style="min-height:300px;">
                <h3 class="mb-30 title_color" style="padding-left:40px;color:rgb(88, 88, 88)">회사간 계약 현황</h3>
                <table class="table table-hover dataTables-example" width="100%" style="text-align:center;">
                    <thead>
                        <tr>
                            <th>번호</th>
                            <th>임치 기술명</th>
                            <th>임치기업</th>
                            <th>계약기업</th>
                            <th>계약기간</th>
                            <th>상태</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for accepted_list in contract_lists %}
                        {% if accepted_list.enroll_idx.user.user_id == user_id or accepted_list.user.user_id == user_id %}
                            <tr>
                                <td>{{accepted_list.enroll_idx.title}}</td>
                                <td>{{accepted_list.enroll_idx.user.com_name}}</td>
                                <td>{{accepted_list.user.com_name}}</td>
                                <td>{{accepted_list.term}} 년</td>
                                {{accepted_list.status | safe}}
                            </tr>    
                        {% endif %}
                    {% endfor %}
                    </tbody>
                    <script>
                        // Table 맨 앞 <td> 태그에 자동으로 인덱스 생성
                        var tables = document.getElementsByTagName('tbody');
                        var table = tables[tables.length - 1];
                        var rows = table.rows;
                        for(var i = 0, td; i < rows.length; i++){
                            td = document.createElement('td');
                            td.appendChild(document.createTextNode(i+1));
                            rows[i].insertBefore(td, rows[i].firstChild);
                        }
                    </script>
                </table>
            </div>
            <br><hr><br>
            <div style="min-height:300px;">
                <h3 class="mb-30 title_color" style="padding-left:40px;color:rgb(88, 88, 88)">내게 들어온 계약요청</h3>
                <table class="table table-hover dataTables-example" width="100%" style="text-align:center;">
                    <thead>
                        <tr>
                            <th>번호</th>
                            <th>임치 기술명</th>
                            <th>회사명</th>
                            <th>대표자</th>
                            <th>계약 기간</th>
                            <th>신청 날짜</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for list in contract_infos %}
                        {% if list.enroll_idx.user.user_id == user_id and list.status == 0 %}
                            <tr>
                                <td><a href="contract_list/{{list.cont_idx}}">{{list.enroll_idx.title}}</a></td>
                                <td>{{list.user.com_name}}</td>
                                <td>{{list.user.com_head}}</td>
                                <td>{{list.term}}</td>
                                <td>{{list.c_date}}</td>
                            </tr>
                        {% endif %}
                    {% endfor %}
                    </tbody>
                    <script>
                        // Table 맨 앞 <td> 태그에 자동으로 인덱스 생성
                        var tables = document.getElementsByTagName('tbody');
                        var table = tables[tables.length - 1];
                        var rows = table.rows;
                        for(var i = 0, td; i < rows.length; i++){
                            td = document.createElement('td');
                            td.appendChild(document.createTextNode(i+1));
                            rows[i].insertBefore(td, rows[i].firstChild);
                        }
                    </script>
                </table>
            </div>
        </div>
    </div>
{% endblock content %}

{% block js %}
<!-- DataTables JavaScript -->
<script src="{% static 'datatables/js/jquery.dataTables.js' %}"></script>
<script src="{% static 'datatables-plugins/dataTables.bootstrap.js' %}"></script>
<script src="{% static 'datatables-responsive/dataTables.responsive.js' %}"></script>

<script>
$(document).ready(function() {
    $('.dataTables-example').DataTable({
        responsive: true
    });
});
</script>
{% endblock js %}